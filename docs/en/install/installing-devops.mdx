---
weight: 30
sourceSHA: b49eb75e9882f9179094b757c4f51359bcc7cafa83afb70016d43a89b5af8c52
---

# Installing DevOps

This guide provides detailed steps for installing `Alauda DevOps`.

## Prerequisites

Ensure the following operators are installed before proceeding:

- `Alauda DevOps v3` operator

## Deployment location

Deploy Katanomi instances in the Global cluster. The business cluster can deploy instances as needed for CI/CD.

<table>
  <tr>
    <th style={{ whiteSpace: 'nowrap' }}>Component</th>
    <th style={{ whiteSpace: 'nowrap' }}>Global Cluster</th>
    <th style={{ whiteSpace: 'nowrap' }}>Business Cluster</th>
  </tr>
  <tr>
    <td>Katanomi</td>
    <td>Installed</td>
    <td>Optional</td>
  </tr>
</table>

## Procedure

<Steps>

  ### Create the Katanomi Instance 

  :::warning
  Only one Katanomi instance is supported.

  - **Global cluster**: Deploy within the `cpaas-system` namespace. Set `ExternalURL` to the `Platform URL` of the `global` cluster and `Service.Type` to `Ingress`.
  - **Business cluster**: Deployment is supported in any namespace.
  :::

  - Login to the `Alauda Container Platform`  platform.
  - Navigate to the **Clusters** tab under `Platform Management`.
  - Select the deployed cluster and click **CLI Tools**.
  - For the `global` cluster, execute the following to obtain the `ExternalURL`:


  ```shell
  export EXTERNAL_URL=$(kubectl get prdb -n cpaas-system base -o jsonpath='{.spec.platformURL}')
  ```

  - Create the Katanomi Instance (adjust parameters as needed)

  ```shell
  cat <<EOF | kubectl apply -f -
  apiVersion: operators.katanomi.dev/v1alpha1
  kind: Katanomi
  metadata:
    name: katanomi
    namespace: cpaas-system
  spec:
    externalURL: ${EXTERNAL_URL}
    replicas: 1
    resources:
      limits:
        cpu: "2"
        memory: 4Gi
      requests:
        cpu: "1"
        memory: 2Gi
    service:
      ingress:
        protocol: HTTP
      type: Ingress
  EOF
  ```

  - Wait for the DevOps Instance to be ready
  ```shell
  kubectl wait --for='jsonpath={.status.conditions[?(@.type=="Running")].status}=true' katanomis/katanomi -n cpaas-system --timeout=5m
  ```

</Steps>

## Katanomi Parameter Description

<table>
  <tr>
    <th style={{ whiteSpace: 'nowrap' }}>Parameter</th>
    <th style={{ whiteSpace: 'nowrap' }}>Description</th>
  </tr>

  <tr>
    <td><b>Name</b></td>

    <td>
      The name of the Katanomi instance.
    </td>
  </tr>

  <tr>
    <td><b>Namespaces</b></td>

    <td>
      For `business clusters`, the Katanomi instance can be deployed to any namespace provided there are sufficient resources available. For `global cluster`, the Katanomi instance must be deployed exclusively in the `cpaas-system` namespace.
    </td>
  </tr>

  <tr>
    <td><b>External URL</b></td>

    <td>
      The access address, which is the API address. Plan according to the configuration of the Service Type.<br />When the Service Type is `Node Port`, please enter `http://<IP>:<Port>`. The **Port** must be consistent with the `Node Port` of the Service, and the API port is used for service access.<br />When the Service Type is `Ingress`, please enter the corresponding access address, for example: `http://kubernetes.io`.
    </td>
  </tr>

  <tr>
    <td><b>Replicas</b></td>

    <td>
      The number of replicas for the Deployment, default is 2. <br />
      When the number of replicas is 1, the single-node deployment is used.
    </td>
  </tr>

  <tr>
    <td><b>Resources</b></td>

    <td>
      - <b>requests:</b> The minimum amount of CPU and memory resources that can be consumed when running the tool.
      - <b>limits:</b> The maximum amount of CPU and memory resources that need to be occupied when running the tool.
    </td>
  </tr>

  <tr>
    <td><b>Service.Type	</b></td>

    <td>
      Required field. Provides two types: Node Port and Ingress.
      - <b>Node Port:</b> Exposes the route through a static port, accessed via `<IP>:<port>`.
      - <b>Ingress:</b> Exposes the route through inbound rules, accessed via a domain name.
    </td>
  </tr>

  <tr>
    <td><b>Service.Ingress</b></td>

    <td>
      Required if Type is set to Ingress.
      - <b>Domain Name:</b> The domain name used to access the tool.
      - <b>Protocol:</b> Access the tool via HTTP or HTTPS.
      - <b>Secret Name:</b> The name of the SSL certificate used when accessing the tool via HTTPS.
    </td>
  </tr>

  <tr>
    <td><b>Service.Node Port</b></td>

    <td>
      Required if <b>Type</b> is set to <b>Node Port</b>. The port number used to access the tool, the API Port and Plugin Port cannot be duplicated, and the port value range is 30000-32767.
      - <b>API Port:</b> The port used to access the Katanomi-api component via HTTP, which is used to perform tool integration binding-related operations.
      - <b>Plugin Port:</b> The port used to access the Katanomi-plugin component via HTTP, which is used in the platform to handle toolchain integration binding events.
    </td>
  </tr>
</table>
